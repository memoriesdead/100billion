(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5994],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var a=s(5155),r=s(2115),i=s(9708),l=s(2085),o=s(9434);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(n({variant:r,size:l,className:s})),ref:t,...c})});d.displayName="Button"},333:(e,t,s)=>{"use strict";s.d(t,{d:()=>o});var a=s(5155),r=s(2115),i=s(4884),l=s(9434);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.bL,{className:(0,l.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(i.zi,{className:(0,l.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});o.displayName=i.bL.displayName},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(5155),r=s(2115),i=s(9434);let l=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"},4770:(e,t,s)=>{"use strict";s.d(t,{default:()=>T});var a=s(5155),r=s(2115),i=s(1046),l=s(4266),o=s(760),n=s(1155),d=s.n(n),c=s(9576),u=s(6927),m=s(3568),f=s(1133),p=s(3374),x=s(9311),h=s(7648),g=s(5318),v=s(8376),b=s(8390),j=s(6923),N=s(285),y=s(8539),w=s(5863),S=s(9434);let P=r.forwardRef((e,t)=>{let{className:s,value:r,...i}=e;return(0,a.jsx)(w.bL,{ref:t,className:(0,S.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...i,children:(0,a.jsx)(w.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});P.displayName=w.bL.displayName;var U=s(7313),k=s(6695),R=s(5057),E=s(2523),C=s(333),A=s(7849);let _=A.Kq,F=A.bL,L=A.l9,I=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,a.jsx)(A.ZL,{children:(0,a.jsx)(A.UC,{ref:t,sideOffset:r,className:(0,S.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...i})})});I.displayName=A.UC.displayName;var z=s(6126),M=s(5365);function T(){let{user:e}=(0,c.As)(),[t,s]=(0,r.useState)(null),[n,w]=(0,r.useState)(null),[S,A]=(0,r.useState)(null),[T,B]=(0,r.useState)(null),[O,D]=(0,r.useState)(null),[W,$]=(0,r.useState)(""),[J,V]=(0,r.useState)([]),[X,G]=(0,r.useState)(""),[K,Y]=(0,r.useState)(!1),[Z,H]=(0,r.useState)(!1),[q,Q]=(0,r.useState)(""),[ee,et]=(0,r.useState)(!1),[es,ea]=(0,r.useState)(0),[er,ei]=(0,r.useState)(null),[el,eo]=(0,r.useState)(null),[en,ed]=(0,r.useState)(0);(0,r.useRef)(null);let ec=()=>{n&&URL.revokeObjectURL(n),s(null),w(null),A(null),B(null),D(null),$(""),V([]),G(""),Y(!1),H(!1),Q(""),et(!1),ea(0),ei(null),eo(null),ed(0)},eu=e=>e.size>0x6400000?(ei("File size exceeds the ".concat(100,"MB limit.")),!1):!!e.type.startsWith("video/")||!!e.type.startsWith("image/")||(ei("Invalid file type. Please select a video or image file."),!1),em=e=>{if(!eu(e))return;s(e);let t=URL.createObjectURL(e);w(t);let a=e.type.startsWith("video/")?"video":"image";A(a),eo(null),B(null),D(null),"video"===a?setTimeout(()=>{ef(t)},500):eo(!0)},ef=e=>{let t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.currentTime=1,t.onloadeddata=()=>{if(t.videoWidth&&t.videoHeight){let e=document.createElement("canvas");e.width=t.videoWidth,e.height=t.videoHeight;let s=e.getContext("2d");if(s){s.drawImage(t,0,0,e.width,e.height);try{let t=e.toDataURL("image/jpeg",.8);D(t)}catch(e){console.error("Error generating thumbnail:",e)}}}},t.onerror=e=>{console.error("Error loading video for thumbnail generation:",e)}},ep=()=>{let e=X.trim().toLowerCase().replace(/[^a-z0-9]/gi,"");e&&!J.includes(e)&&J.length<5&&(V([...J,e]),G(""))},ex=e=>{V(J.filter(t=>t!==e))},eh=(0,r.useCallback)(e=>{ec(),e.length>0&&em(e[0])},[em,ec]),{getRootProps:eg,getInputProps:ev,isDragActive:eb,isDragAccept:ej,isDragReject:eN}=(0,i.VB)({onDrop:eh,accept:{"video/*":[".mp4",".mov",".avi",".webm"],"image/*":[".jpeg",".png",".jpg",".gif",".webp"]},maxFiles:1,multiple:!1,maxSize:0x6400000,onDropRejected:e=>{let t=e[0];if(t){let e=t.errors[0];"file-too-large"===e.code?ei("File is too large. Max size is ".concat(100,"MB.")):"file-invalid-type"===e.code?ei("Invalid file type. Please upload a supported video or image."):ei("File rejected. Please try again.")}ec()}}),ey=async()=>{if(!e){ei("You must be logged in to upload."),m.oR.error("You must be logged in to upload.");return}if(!t){ei("Please select a file to upload."),m.oR.error("Please select a file to upload.");return}if(!W.trim()){ei("Please enter a caption."),m.oR.error("Please enter a caption.");return}if("video"===S&&!el){ei("Video duration must be ".concat(60," seconds or less.")),m.oR.error("Video duration must be ".concat(60," seconds or less."));return}let s=null;if(Z){if(!q||isNaN(parseFloat(q))){ei("Please enter a valid price for the item."),m.oR.error("Please enter a valid price.");return}if((s=Math.round(100*parseFloat(q)))<50){ei("Price must be at least $".concat("0.50",".")),m.oR.error("Price must be at least $".concat("0.50","."));return}}if(!S){ei("Media type could not be determined. Please re-select the file."),m.oR.error("Media type could not be determined. Please re-select the file."),et(!1);return}et(!0),ei(null),ea(0);let a=m.oR.loading("Preparing to upload...");try{console.log("[Upload] Step 1: Checking user profile..."),m.oR.loading("Checking user profile...",{id:a});let{data:r,error:i}=await u.N.from("profiles").select("id").eq("id",e.id).maybeSingle();if(i)throw console.error("[Upload Error] Supabase profile check failed:",i),Error("Failed to check profile: ".concat(i.message));if(console.log("[Upload] Profile check result:",r?"Exists":"Does not exist","Error:",i),r)console.log("[Upload] Step 2: Profile already exists, skipping creation.");else{m.oR.loading("Creating user profile...",{id:a});let t="user_".concat(e.id.substring(0,8));console.log("[Upload] Step 2: Profile not found. Attempting to create profile with id=".concat(e.id,", uid=").concat(e.id,", username=").concat(t));let{error:s}=await u.N.from("profiles").insert({id:e.id,uid:e.id,username:t});if(s)if("23505"===s.code)throw console.warn("Temporary username ".concat(t," conflict. Profile might already exist or needs manual update.")),console.error("[Upload Error] Profile username conflict for ".concat(t,"."),s),m.oR.error("Profile username conflict. Please try again or update your profile.",{id:a}),Error("Profile username conflict.");else throw console.error("[Upload Error] Failed to create profile:",s),Error("Failed to create profile: ".concat(s.message));console.log("[Upload] Step 2: User profile created successfully.")}let l="video"===S?"videos":"images";console.log("[Upload] Step 3: Uploading ".concat(S," to bucket '").concat(l,"'..."));let o="".concat(e.id,"/").concat(Date.now(),"_").concat(t.name);console.log("[Upload] Media file path: ".concat(o)),m.oR.loading("Uploading ".concat(S,"..."),{id:a});let{data:n,error:d}=await u.N.storage.from(l).upload(o,t,{cacheControl:"3600",upsert:!1});if(d)throw d;console.log("[Upload] Step 3: ".concat(S," uploaded successfully.")),m.oR.loading("Processing...",{id:a}),console.log("[Upload] Step 4: Getting public URL for ".concat(S,"..."));let{data:c}=u.N.storage.from(l).getPublicUrl(o),f=null==c?void 0:c.publicUrl;if(!f)throw Error("Failed to get public URL for ".concat(S));console.log("[Upload] Step 4: Got public URL: ".concat(f));let p=null;if("video"===S&&O){console.log("[Upload] Step 5: Uploading video thumbnail...");try{let t=await fetch(O),s=await t.blob(),a="thumbnails/".concat(e.id,"/").concat(Date.now(),"_thumbnail.jpg");console.log("[Upload] Thumbnail file path: ".concat(a));let{error:r}=await u.N.storage.from("thumbnails").upload(a,s,{upsert:!1});if(r)throw r;let{data:i}=u.N.storage.from("thumbnails").getPublicUrl(a);p=(null==i?void 0:i.publicUrl)||null,console.log("[Upload] Step 5a: Got thumbnail public URL: ".concat(p))}catch(e){console.warn("[Upload Warning] Error during thumbnail processing/upload:",e)}}else"video"===S?console.log("[Upload] Step 5: Skipping thumbnail upload."):console.log("[Upload] Step 6: Skipping Stripe product/price creation (will be handled at checkout).");console.log("[Upload] Step 7: Preparing post metadata for database insert...");let x={user_id:e.id,caption:W.trim(),tags:J,is_private:K,likes_count:0,views_count:0,comments_count:0,type:S,is_for_sale:Z,price:Z?s:null,currency:Z?"usd":null,stripe_product_id:null,stripe_price_id:null,..."video"===S&&{video_url:f,thumbnail_url:p,duration:T?Math.round(T):0},..."image"===S&&{image_url:f}};console.log("[Upload] Post data to insert:",x),console.log("[Upload] Step 8: Inserting post metadata into database..."),m.oR.loading("Saving post details...",{id:a});let{error:h}=await u.N.from("posts").insert(x);if(h)throw await u.N.storage.from(l).remove([o]),p&&await u.N.storage.from("thumbnails").remove([p.split("/").pop()]),h;console.log("[Upload] Step 8: Post metadata inserted successfully."),m.oR.success("".concat("video"===S?"Video":"Image"," published successfully!"),{id:a}),ec()}catch(t){let e=t instanceof Error?t.message:String(t);console.error("[Upload Error] Overall upload process failed:",t),ei("Operation failed: ".concat(e)),m.oR.error("Operation failed: ".concat(e),{id:a})}finally{console.log("[Upload] Upload process finished (finally block)."),et(!1)}},ew=()=>{if(0===en){if(!t)return void m.oR.error("Please select a file first.");if("video"===S&&!el)return void m.oR.error("Video duration is invalid.")}if(1===en&&!W.trim())return void m.oR.error("Please enter a caption.");en<2&&ed(en+1)},eS=()=>{en>0&&ed(en-1)},eP=()=>0===en?!t||"video"===S&&!el:1===en?!W.trim():2!==en||ee||!t||!W.trim()||"video"===S&&!el;return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 flex justify-center min-h-[calc(100vh-80px)]",children:[(0,a.jsx)(m.l$,{position:"top-center",reverseOrder:!1}),(0,a.jsxs)(k.Zp,{className:"w-full max-w-4xl border bg-card shadow-xl overflow-hidden",children:[(0,a.jsxs)(k.aR,{className:"pb-4",children:[(0,a.jsx)(k.ZB,{className:"text-2xl md:text-3xl font-bold text-center",children:"Create New Post"}),(0,a.jsx)(k.BT,{className:"text-center",children:"Share a video or image with your subscribers"})]}),(0,a.jsxs)(k.Wu,{children:[(null==e?void 0:e.id)&&(0,a.jsxs)(M.Fc,{variant:"default",className:"mb-6 bg-blue-900/20 border-blue-500 text-blue-300",children:[" ",(0,a.jsx)(f.A,{className:"h-4 w-4 text-blue-400"}),(0,a.jsx)(M.XL,{className:"text-blue-300",children:"Debug Info"}),(0,a.jsxs)(M.TN,{className:"text-blue-400",children:["Current User ID: ",e.id]})]}),er&&(0,a.jsxs)(M.Fc,{variant:"destructive",className:"mb-6",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)(M.XL,{children:"Error"}),(0,a.jsx)(M.TN,{children:er})]}),(0,a.jsxs)(U.tU,{value:String(en),onValueChange:e=>ed(parseInt(e)),className:"relative",children:[(0,a.jsxs)(U.j7,{className:"grid w-full grid-cols-3 mb-6",children:[(0,a.jsx)(U.Xi,{value:"0",disabled:ee,children:"1. Upload"}),(0,a.jsx)(U.Xi,{value:"1",disabled:!t||"video"===S&&!el||ee,children:"2. Details"}),(0,a.jsx)(U.Xi,{value:"2",disabled:!t||!W.trim()||"video"===S&&!el||ee,children:"3. Review"})]}),(0,a.jsxs)(U.av,{value:"0",className:"space-y-4",children:[(0,a.jsxs)("div",{...eg({className:"relative border-2 border-dashed rounded-lg p-6 transition-colors duration-200 ease-in-out cursor-pointer\n      ".concat(eb?"border-primary bg-primary/10":"border-border hover:border-primary/80","\n      ").concat(ej?"border-green-500 bg-green-50 dark:bg-green-900/20":"","\n      ").concat(eN?"border-red-500 bg-red-50 dark:bg-red-900/20":"","\n      ").concat(n?"":"min-h-[200px] flex flex-col justify-center items-center")}),children:[(0,a.jsx)("input",{...ev()}),n?(0,a.jsx)(o.N,{children:(0,a.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"relative w-full aspect-video bg-muted rounded-lg overflow-hidden flex items-center justify-center",children:[(0,a.jsx)(N.$,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 z-10 rounded-full h-7 w-7",onClick:e=>{e.stopPropagation(),ec()},children:(0,a.jsx)(g.A,{className:"h-4 w-4"})}),"video"===S&&n&&(0,a.jsx)(d(),{url:n,controls:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0},onDuration:e=>{"video"===S&&(B(e),e>60?(ei("Video is too long (".concat(Math.round(e),"s). Maximum duration is ").concat(60," seconds.")),eo(!1)):(eo(!0),ei(null)))},onError:e=>{console.error("ReactPlayer Error:",e),ei("Could not load video preview.")}}),"image"===S&&n&&(0,a.jsx)("img",{src:n,alt:"Image preview",className:"max-h-full max-w-full object-contain"}),"video"===S&&null!==T&&(0,a.jsx)("div",{className:"absolute bottom-2 left-2 px-2 py-1 rounded text-xs font-medium backdrop-blur-sm\n                          ".concat(!1===el?"bg-red-600/80 text-white":"bg-black/60 text-white"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[!1===el?(0,a.jsx)(f.A,{className:"h-3 w-3"}):(0,a.jsx)(v.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[Math.round(T),"s / ",60,"s"]})]})})]})}):(0,a.jsx)("div",{className:"text-center text-muted-foreground p-4",children:(0,a.jsxs)(l.P.div,{initial:{scale:.9,opacity:.5},animate:{scale:1,opacity:1},transition:{duration:.3},className:"flex flex-col items-center justify-center space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4 text-primary",children:[(0,a.jsx)(p.A,{className:"h-10 w-10"}),(0,a.jsx)(x.A,{className:"h-10 w-10"})]}),(0,a.jsx)("p",{className:"font-semibold text-lg",children:"Drag & drop video or image here"}),(0,a.jsx)("p",{className:"text-sm",children:"or click to select file"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-xs text-muted-foreground",children:[(0,a.jsx)(h.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Video: Max ",60,"s"]}),(0,a.jsx)("span",{children:"â€¢"}),(0,a.jsxs)("span",{children:["Max Size: ",100,"MB"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground pt-2",children:"(MP4, MOV, JPG, PNG, GIF, etc.)"})]})})]}),(0,a.jsx)("div",{className:"flex justify-end pt-4",children:(0,a.jsx)(N.$,{onClick:ew,disabled:eP(),className:"w-full md:w-auto",children:"Continue"})})]}),(0,a.jsxs)(U.av,{value:"1",className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(R.J,{htmlFor:"caption",className:"text-base font-medium",children:"Caption"}),(0,a.jsx)(y.T,{id:"caption",value:W,onChange:e=>$(e.target.value),placeholder:"Write a caption for your ".concat(null!=S?S:"post","..."),rows:3,maxLength:2200,className:"mt-1.5 resize-none bg-background",disabled:ee}),(0,a.jsxs)("div",{className:"flex justify-end mt-1 text-xs text-muted-foreground",children:[W.length," / 2200"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R.J,{htmlFor:"tags",className:"text-base font-medium",children:"Tags (up to 5)"}),(0,a.jsxs)("div",{className:"flex mt-1.5",children:[(0,a.jsx)("input",{type:"text",id:"tags",value:X,onChange:e=>G(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ep())},placeholder:"Add a tag and press Enter",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",disabled:J.length>=5||ee}),(0,a.jsx)(N.$,{type:"button",variant:"outline",className:"ml-2 shrink-0",onClick:ep,disabled:!X.trim()||J.length>=5||ee,children:"Add"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[J.map(e=>(0,a.jsxs)(z.E,{variant:"secondary",className:"flex items-center gap-1 py-1 px-2",children:["#",e,(0,a.jsx)(N.$,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 ml-1 opacity-60 hover:opacity-100 hover:bg-transparent",onClick:()=>ex(e),disabled:ee,"aria-label":"Remove tag ".concat(e),children:(0,a.jsx)(g.A,{className:"h-3 w-3"})})]},e)),J.length<5&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground self-center",children:["You can add ",5-J.length," more tags."]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(R.J,{htmlFor:"private-switch",className:"text-base font-medium",children:"Private Post"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Only you will see this post (feature WIP)"})]}),(0,a.jsx)(C.d,{id:"private-switch",checked:K,onCheckedChange:Y,disabled:ee})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(R.J,{htmlFor:"sale-switch",className:"text-base font-medium",children:"Mark as For Sale"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set a price for direct purchase."})]}),(0,a.jsx)(C.d,{id:"sale-switch",checked:Z,onCheckedChange:H,disabled:ee})]}),(0,a.jsx)(o.N,{children:Z&&(0,a.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:(0,a.jsxs)("div",{className:"pt-4",children:[(0,a.jsx)(R.J,{htmlFor:"sale-price",className:"text-base font-medium",children:"Price (USD)"}),(0,a.jsxs)("div",{className:"relative mt-1.5",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(E.p,{id:"sale-price",type:"number",value:q,onChange:e=>Q(e.target.value),placeholder:"e.g., 5.00",className:"pl-8",step:"0.01",min:"0.50",disabled:ee})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Minimum price is $","0.50","."]})]})},"price-input")})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,a.jsx)(N.$,{variant:"outline",onClick:eS,disabled:ee,children:"Back"}),(0,a.jsx)(N.$,{onClick:ew,disabled:eP(),children:"Continue"})]})]}),(0,a.jsxs)(U.av,{value:"2",className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium text-lg",children:"Preview"}),(0,a.jsxs)("div",{className:"rounded-lg overflow-hidden border bg-muted aspect-video flex items-center justify-center relative",children:["video"===S&&n&&(0,a.jsx)(d(),{url:n,controls:!0,width:"100%",height:"100%",light:O||!0,style:{position:"absolute",top:0,left:0}}),"image"===S&&n&&(0,a.jsx)("img",{src:n,alt:"Final preview",className:"max-h-full max-w-full object-contain"}),!n&&(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"No preview available"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium text-lg",children:"Details"}),(0,a.jsxs)("div",{className:"rounded-md border bg-background p-4 space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Caption"}),(0,a.jsx)("p",{className:"mt-1 whitespace-pre-wrap break-words",children:W||"(No caption)"})]}),J.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1.5 mt-1",children:J.map(e=>(0,a.jsxs)(z.E,{variant:"outline",className:"text-xs px-1.5 py-0.5",children:["#",e]},e))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Visibility"}),(0,a.jsx)(z.E,{variant:K?"secondary":"outline",className:"text-xs",children:K?"Private":"Public"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Access"}),(0,a.jsx)(z.E,{variant:Z?"default":"outline",className:"text-xs ".concat(Z?"bg-green-600 hover:bg-green-700 text-white border-green-700":""),children:Z?"For Sale ($".concat(q||"?.??",")"):"Free"})]}),"video"===S&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Duration"}),(0,a.jsx)(z.E,{variant:"outline",className:"text-xs",children:T?"".concat(Math.round(T),"s"):"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(R.J,{className:"text-xs text-muted-foreground font-semibold",children:"Type"}),(0,a.jsx)(z.E,{variant:"outline",className:"text-xs capitalize",children:S||"N/A"})]})]})]})]}),ee&&(0,a.jsxs)("div",{className:"space-y-2 pt-4",children:[(0,a.jsx)(P,{value:es,className:"w-full h-2"}),(0,a.jsxs)("p",{className:"text-sm text-center text-muted-foreground flex items-center justify-center gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 animate-pulse"}),"Uploading... ",Math.round(es),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,a.jsx)(N.$,{variant:"outline",onClick:eS,disabled:ee,children:"Back"}),(0,a.jsx)(_,{children:(0,a.jsxs)(F,{children:[(0,a.jsx)(L,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(N.$,{onClick:ey,disabled:eP(),className:"min-w-[120px]","aria-label":"Publish post",children:ee?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2 animate-pulse"}),"Uploading..."]}):"Publish ".concat(S?"video"===S?"Video":"Image":"Post")})})}),(0,a.jsx)(I,{children:(0,a.jsx)("p",{children:"Share your content with the world!"})})]})})]})]})]})]})]})]})}},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var a=s(5155),r=s(2115),i=s(968),l=s(2085),o=s(9434);let n=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.b,{ref:t,className:(0,o.cn)(n(),s),...r})});d.displayName=i.b.displayName},5365:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>n,TN:()=>c,XL:()=>d});var a=s(5155),r=s(2115),i=s(2085),l=s(9434);let o=(0,i.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n=r.forwardRef((e,t)=>{let{className:s,variant:r,...i}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(o({variant:r}),s),...i})});n.displayName="Alert";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})});d.displayName="AlertTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",s),...r})});c.displayName="AlertDescription"},6126:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var a=s(5155);s(2115);var r=s(2085),i=s(9434);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)(l({variant:s}),t),...r})}},6695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>o,wL:()=>u});var a=s(5155),r=s(2115),i=s(9434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});l.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});o.displayName="CardHeader";let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",s),...r})});n.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},6927:(e,t,s)=>{"use strict";s.d(t,{N:()=>o});var a=s(851),r=s(9509);let i=r.env.NEXT_PUBLIC_SUPABASE_URL,l=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!i)throw Error("Supabase URL is missing. Make sure NEXT_PUBLIC_SUPABASE_URL is set in your environment variables.");if(!l)throw Error("Supabase Anon Key is missing. Make sure NEXT_PUBLIC_SUPABASE_ANON_KEY is set in your environment variables.");let o=(0,a.UU)(i,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},7313:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>d,av:()=>c,j7:()=>n,tU:()=>o});var a=s(5155),r=s(2115),i=s(64),l=s(9434);let o=i.bL,n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.B8,{ref:t,className:(0,l.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...r})});n.displayName=i.B8.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...r})});d.displayName=i.l9.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});c.displayName=i.UC.displayName},8394:(e,t,s)=>{Promise.resolve().then(s.bind(s,4770))},8539:(e,t,s)=>{"use strict";s.d(t,{T:()=>l});var a=s(5155),r=s(2115),i=s(9434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});l.displayName="Textarea"},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var a=s(2596),r=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},9576:(e,t,s)=>{"use strict";s.d(t,{As:()=>n,OJ:()=>o,cy:()=>l});var a=s(5155),r=s(2115),i=s(6927);let l=(0,r.createContext)({user:null,session:null,loading:!0,signInWithGoogle:async()=>{console.warn("signInWithGoogle called before AuthProvider initialized")},signUpWithEmail:async()=>{console.warn("signUpWithEmail called before AuthProvider initialized")},signInWithEmail:async()=>{console.warn("signInWithEmail called before AuthProvider initialized")},sendPasswordReset:async()=>{console.warn("sendPasswordReset called before AuthProvider initialized")},signOut:async()=>{console.warn("signOut called before AuthProvider initialized")}}),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)(null),[n,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{var e;let{data:{session:t},error:s}=await i.N.auth.getSession();if(s)throw s;d(t),o(null!=(e=null==t?void 0:t.user)?e:null)}catch(e){console.error("Error fetching initial Supabase session:",e)}finally{u(!1)}})();let{data:e}=i.N.auth.onAuthStateChange(async(e,t)=>{var s;console.log("Supabase auth state changed:",e,t),d(t),o(null!=(s=null==t?void 0:t.user)?s:null)});return()=>{null==e||e.subscription.unsubscribe()}},[]);let m=async()=>{u(!0);try{let{error:e}=await i.N.auth.signInWithOAuth({provider:"google"});if(e)throw e}catch(e){console.error("Error signing in with Google (Supabase):",e),u(!1)}},f=async(e,t)=>{u(!0);try{let{data:s,error:a}=await i.N.auth.signUp({email:e,password:t});if(a)throw a;s.user&&!s.user.email_confirmed_at&&console.log("Sign up successful. Please check your email for verification.")}catch(e){console.error("Error signing up (Supabase):",e),u(!1)}},p=async(e,t)=>{u(!0);try{let{error:s}=await i.N.auth.signInWithPassword({email:e,password:t});if(s)throw s}catch(e){console.error("Error signing in (Supabase):",e),u(!1)}},x=async e=>{try{let{error:t}=await i.N.auth.resetPasswordForEmail(e,{});if(t)throw t;console.log("Password reset email sent (Supabase).")}catch(e){console.error("Error sending password reset email (Supabase):",e)}},h=async()=>{try{let{error:e}=await i.N.auth.signOut();if(e)throw e;console.log("Supabase sign out successful.")}catch(e){console.error("Error signing out from Supabase:",e)}};return(0,a.jsx)(l.Provider,{value:{user:s,session:n,loading:c,signInWithGoogle:m,signUpWithEmail:f,signInWithEmail:p,sendPasswordReset:x,signOut:h},children:c?(0,a.jsx)("div",{children:"Loading Authentication..."}):t})},n=()=>(0,r.useContext)(l)}},e=>{var t=t=>e(e.s=t);e.O(0,[851,3953,3568,8312,7328,2596,8441,1684,7358],()=>t(8394)),_N_E=e.O()}]);
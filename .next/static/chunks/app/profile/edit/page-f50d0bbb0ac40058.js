(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4029],{1883:(e,r,a)=>{Promise.resolve().then(a.bind(a,6890))},5365:(e,r,a)=>{"use strict";a.d(r,{Fc:()=>d,TN:()=>c,XL:()=>o});var t=a(5155),s=a(2115),i=a(2085),l=a(9434);let n=(0,i.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=s.forwardRef((e,r)=>{let{className:a,variant:s,...i}=e;return(0,t.jsx)("div",{ref:r,role:"alert",className:(0,l.cn)(n({variant:s}),a),...i})});d.displayName="Alert";let o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("h5",{ref:r,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})});o.displayName="AlertTitle";let c=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),...s})});c.displayName="AlertDescription"},6695:(e,r,a)=>{"use strict";a.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n,wL:()=>u});var t=a(5155),s=a(2115),i=a(9434);let l=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...s})});l.displayName="Card";let n=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});n.displayName="CardHeader";let d=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("font-semibold leading-none tracking-tight",a),...s})});d.displayName="CardTitle";let o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},6890:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>N});var t=a(5155),s=a(2115),i=a(4304),l=a(285),n=a(2523),d=a(5057),o=a(8539),c=a(6695);function u(e){let{initialProfileData:r,onSave:a,onCancel:i,isSaving:u}=e,[m,x]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[h,v]=(0,s.useState)(""),[b,g]=(0,s.useState)("");return(0,s.useEffect)(()=>{var e,a;x(r.name||""),p(r.username||""),v(r.bio||""),g(null!=(a=null==(e=r.subscription_price)?void 0:e.toString())?a:"")},[r]),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Profile Details"}),(0,t.jsx)(c.BT,{children:"Update your name, username, and bio."})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let r=null;if(""!==b.trim()){let e=parseFloat(b);if(isNaN(e)||e<0)return void alert("Please enter a valid, non-negative subscription price or leave it blank for free content.");r=e}a({name:m.trim(),username:f.trim(),bio:h.trim(),subscription_price:r})},children:[(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d.J,{htmlFor:"name",children:"Name"}),(0,t.jsx)(n.p,{id:"name",value:m,onChange:e=>x(e.target.value),placeholder:"Your full name",disabled:u})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d.J,{htmlFor:"username",children:"Username"}),(0,t.jsx)(n.p,{id:"username",value:f,onChange:e=>p(e.target.value),placeholder:"Your unique username",disabled:u}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Usernames can only contain letters, numbers, underscores, and periods."})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d.J,{htmlFor:"bio",children:"Bio"}),(0,t.jsx)(o.T,{id:"bio",value:h,onChange:e=>v(e.target.value),placeholder:"Tell us a little about yourself",rows:4,maxLength:150,className:"resize-none",disabled:u}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[h.length," / 150"]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d.J,{htmlFor:"subscriptionPrice",children:"Monthly Subscription Price (USD)"}),(0,t.jsx)(n.p,{id:"subscriptionPrice",type:"number",step:"0.01",min:"0",value:b,onChange:e=>g(e.target.value),placeholder:"Leave blank for free",disabled:u,className:"w-1/2"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Set a price for users to subscribe to your exclusive content. Leave blank if all your content is free."})]})]}),(0,t.jsxs)(c.wL,{className:"flex justify-end gap-2",children:[(0,t.jsx)(l.$,{type:"button",variant:"outline",onClick:i,disabled:u,children:"Cancel"}),(0,t.jsx)(l.$,{type:"submit",disabled:u,children:u?"Saving...":"Save Profile"})]})]})]})}var m=a(9576),x=a(5365),f=a(6874),p=a.n(f),h=a(2346),v=a(6927),b=a(6715),g=a(9373),j=a(5041),y=a(5695);function N(){let{user:e,loading:r}=(0,m.As)(),a=(0,b.jE)(),s=(0,y.useRouter)(),{data:n,isLoading:d,error:o}=(0,g.I)({queryKey:["editProfile",null==e?void 0:e.id],queryFn:async()=>{if(!(null==e?void 0:e.id))return null;let{data:r,error:a}=await v.N.from("profiles").select("username, name, bio, subscription_price").eq("id",e.id).single();if(a&&"PGRST116"!==a.code)throw a;return r},enabled:!!(null==e?void 0:e.id)&&!r}),c=(0,j.n)({mutationFn:async r=>{if(!(null==e?void 0:e.id))throw Error("User not authenticated");let{error:a}=await v.N.from("profiles").update({name:r.name,username:r.username,bio:r.bio,subscription_price:r.subscription_price,updated_at:new Date().toISOString()}).eq("id",e.id);if(a)throw a},onSuccess:()=>{a.invalidateQueries({queryKey:["profile",null==e?void 0:e.id]}),a.invalidateQueries({queryKey:["editProfile",null==e?void 0:e.id]}),s.push("/profile")},onError:e=>{console.error("Failed to update profile:",e)}});return r||d?(0,t.jsx)(i.MainLayout,{children:(0,t.jsxs)("div",{className:"flex justify-center items-center min-h-[70vh]",children:[(0,t.jsx)("p",{children:"Loading..."})," "]})}):e?(0,t.jsx)(i.MainLayout,{children:(0,t.jsxs)("div",{className:"container max-w-3xl mx-auto px-4 py-8 space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Edit Profile"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Update your profile information and images."})]}),(0,t.jsx)(h.w,{}),o?(0,t.jsxs)(x.Fc,{variant:"destructive",children:[(0,t.jsx)(x.XL,{children:"Error Loading Profile Data"}),(0,t.jsx)(x.TN,{children:o.message})]}):n?(0,t.jsx)(u,{initialProfileData:n,onSave:e=>{c.mutate(e)},onCancel:()=>{s.push("/profile")},isSaving:c.isPending}):(0,t.jsx)("p",{children:"Could not load profile data to edit."})]})}):(0,t.jsx)(i.MainLayout,{children:(0,t.jsx)("div",{className:"container max-w-2xl mx-auto px-4 py-12",children:(0,t.jsxs)(x.Fc,{children:[(0,t.jsx)(x.XL,{children:"Authentication Required"}),(0,t.jsxs)(x.TN,{children:["You need to be logged in to edit your profile.",(0,t.jsx)(l.$,{variant:"link",className:"p-0 h-auto ml-2",asChild:!0,children:(0,t.jsx)(p(),{href:"/login",children:"Log In"})})]})]})})})}},8539:(e,r,a)=>{"use strict";a.d(r,{T:()=>l});var t=a(5155),s=a(2115),i=a(9434);let l=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:r,...s})});l.displayName="Textarea"}},e=>{var r=r=>e(e.s=r);e.O(0,[6711,4206,851,3953,6671,1733,3568,8312,1144,4550,9373,7431,3762,4304,8441,1684,7358],()=>r(1883)),_N_E=e.O()}]);
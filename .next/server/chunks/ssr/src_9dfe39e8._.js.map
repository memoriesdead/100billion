{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/components/ui/avatar.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Avatar = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAvatar.displayName = AvatarPrimitive.Root.displayName\r\n\r\nconst AvatarImage = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Image>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Image\r\n    ref={ref}\r\n    className={cn(\"aspect-square h-full w-full\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\r\n\r\nconst AvatarFallback = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Fallback\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\r\n\r\nexport { Avatar, AvatarImage, AvatarFallback }\r\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,OAAoB;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,OAAO,WAAW,GAAG,kKAAA,CAAA,OAAoB,CAAC,WAAW;AAErD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,QAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,+BAA+B;QAC5C,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,kKAAA,CAAA,QAAqB,CAAC,WAAW;AAE3D,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,WAAwB;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,wEACA;QAED,GAAG,KAAK;;;;;;AAGb,eAAe,WAAW,GAAG,kKAAA,CAAA,WAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/components/PostInteractionButtons.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useCallback, useContext } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation'; // Keep useRouter import\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { AuthContext } from '@/context/AuthContext';\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\n// Use Font Awesome icons for closer match to original screenshot\r\nimport { FaHeart, FaCommentDots, FaShare } from \"react-icons/fa\";\r\nimport { Lock, Unlock, ShoppingCart, Loader2 } from 'lucide-react'; // Keep Lock/Unlock for internal logic if needed elsewhere, but remove from UI stack\r\nimport { toast } from 'sonner';\r\nimport { Button } from '@/components/ui/button';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\n\r\n// Initialize Stripe outside the component\r\nconst stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY!);\r\n\r\ninterface PostInteractionButtonsProps {\r\n  postId: string;\r\n  userId: string; // ID of the post owner\r\n  // onProfileClick prop removed\r\n  username: string;\r\n  profilePictureUrl?: string;\r\n  currentLikes: number; // Changed from initialLikes\r\n  isLiked: boolean; // Changed from initialIsLiked\r\n  onLikeClick: (source?: 'button' | 'doubleTap') => void; // Changed from onLikeSuccess\r\n  commentsCount: string;\r\n  sharesCount: string;\r\n  initialIsPrivate: boolean;\r\n  isOwner: boolean;\r\n  videoCaption?: string;\r\n  postType: 'video' | 'image';\r\n  is_for_sale: boolean;\r\n  price?: number | null;\r\n  currency?: string | null;\r\n  // onLikeSuccess removed\r\n}\r\n\r\nexport function PostInteractionButtons({\r\n  postId,\r\n  userId,\r\n  username,\r\n  profilePictureUrl,\r\n  currentLikes, // Use new prop\r\n  isLiked, // Use new prop\r\n  onLikeClick, // Use new prop\r\n  commentsCount,\r\n  sharesCount,\r\n  initialIsPrivate,\r\n  isOwner,\r\n  videoCaption,\r\n  postType,\r\n  is_for_sale,\r\n  price,\r\n  currency,\r\n  // onLikeSuccess removed\r\n  // onProfileClick removed from destructuring\r\n}: PostInteractionButtonsProps) {\r\n  const router = useRouter(); // Keep router instance\r\n  const { user: loggedInUser } = useContext(AuthContext);\r\n  // Remove internal like state - use props instead\r\n  // const [isLiked, setIsLiked] = useState(initialIsLiked);\r\n  // const [currentLikes, setCurrentLikes] = useState(initialLikes);\r\n  const [currentIsPrivate, setCurrentIsPrivate] = useState(initialIsPrivate);\r\n  const [isUpdatingPrivacy, setIsUpdatingPrivacy] = useState(false);\r\n  const [isCheckoutLoading, setIsCheckoutLoading] = useState(false);\r\n\r\n  // --- Like Handler Removed (now handled by parent) ---\r\n\r\n  // --- Share Handler ---\r\n  const handleShare = useCallback(async () => {\r\n    const shareData = {\r\n      title: `Check out this post by @${username}!`,\r\n      text: videoCaption || `Check out this post by @${username}!`,\r\n      url: postType === 'video'\r\n         ? `${window.location.origin}/video/${postId}`\r\n         : `${window.location.origin}/image/${postId}`,\r\n    };\r\n    try {\r\n      if (navigator.share) {\r\n        await navigator.share(shareData);\r\n      } else {\r\n        await navigator.clipboard.writeText(shareData.url);\r\n        toast.success(\"Link copied to clipboard!\");\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sharing:', error);\r\n      if ((error as DOMException).name !== 'AbortError') {\r\n        toast.error(\"Could not share post.\");\r\n      }\r\n    }\r\n  }, [postId, username, videoCaption, postType]);\r\n\r\n  // --- Privacy Toggle Handler ---\r\n  const handleTogglePrivacy = useCallback(async () => {\r\n    if (!isOwner || isUpdatingPrivacy || !loggedInUser) {\r\n      if (!loggedInUser) toast.error(\"You must be logged in.\");\r\n      return;\r\n    }\r\n    setIsUpdatingPrivacy(true);\r\n    const originalIsPrivate = currentIsPrivate;\r\n    const newIsPrivate = !currentIsPrivate;\r\n    setCurrentIsPrivate(newIsPrivate); // Optimistic update\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('posts')\r\n        .update({ is_private: newIsPrivate })\r\n        .eq('id', postId)\r\n        .eq('user_id', loggedInUser.id);\r\n      if (error) throw error;\r\n      toast.success(`Post set to ${newIsPrivate ? 'Private' : 'Public'}`);\r\n    } catch (error: unknown) {\r\n      const message = error instanceof Error ? error.message : String(error);\r\n      setCurrentIsPrivate(originalIsPrivate); // Revert on error\r\n      toast.error(\"Failed to update privacy status.\");\r\n      console.error('Error updating privacy status:', message);\r\n    } finally {\r\n      setIsUpdatingPrivacy(false);\r\n    }\r\n  }, [isOwner, isUpdatingPrivacy, loggedInUser, postId, currentIsPrivate]);\r\n\r\n  // --- Purchase Handler ---\r\n  const handlePurchase = useCallback(async () => {\r\n    if (!loggedInUser) {\r\n      toast.info(\"Please log in to purchase items.\");\r\n      return;\r\n    }\r\n    if (!postId || !is_for_sale || !price || price <= 0) {\r\n      toast.error(\"This item cannot be purchased currently.\");\r\n      return;\r\n    }\r\n    setIsCheckoutLoading(true);\r\n    try {\r\n      const response = await fetch('/api/stripe/create-item-checkout-session', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ postId }),\r\n      });\r\n      const sessionData = await response.json();\r\n      if (!response.ok) throw new Error(sessionData.error || 'Failed to create checkout session');\r\n      if (!sessionData.sessionId) throw new Error('Session ID not received from server');\r\n      const stripe = await stripePromise;\r\n      if (!stripe) throw new Error('Stripe.js failed to load.');\r\n      const { error: stripeError } = await stripe.redirectToCheckout({ sessionId: sessionData.sessionId });\r\n      if (stripeError) throw new Error(stripeError.message);\r\n    } catch (error) {\r\n      console.error('Purchase initiation error:', error);\r\n      toast.error(`Failed to initiate purchase: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsCheckoutLoading(false);\r\n    }\r\n   }, [loggedInUser, postId, is_for_sale, price]);\r\n\r\n   const PrivacyIcon = currentIsPrivate ? Lock : Unlock;\r\n\r\n   // Determine container classes based on is_for_sale\r\n  const containerClasses = is_for_sale\r\n    ? \"absolute top-4 right-4 z-20 pointer-events-auto\" // Top-right for sale items\r\n    : \"absolute bottom-12 right-3 z-20 flex flex-col items-end space-y-1 pointer-events-auto\"; // Position even lower, tighten spacing, adjust right offset\r\n\r\n  return (\r\n    <div className={containerClasses}>\r\n      {/* Profile Link (Always rendered, position handled by container) */}\r\n      <Link\r\n        href={`/profile/${username}`} // Link to the user's profile page\r\n        onClick={(e) => {\r\n          e.stopPropagation(); // Prevent parent Link navigation\r\n        }}\r\n        className={`profile-link-area text-white cursor-pointer ${!is_for_sale && postType === 'video' ? 'mt-4' : ''} ${!is_for_sale ? 'mb-1' : ''} ${is_for_sale ? '' : 'flex flex-col items-center'}`}\r\n        aria-label={`View profile for ${username}`}\r\n      >\r\n        <Avatar className=\"w-10 h-10 border-2 border-white\">\r\n          <AvatarImage src={profilePictureUrl ?? ''} alt={`${username}'s profile picture`} />\r\n          <AvatarFallback>{username?.charAt(0).toUpperCase() ?? 'U'}</AvatarFallback>\r\n        </Avatar>\r\n      </Link>\r\n\r\n      {/* Like Button (Only render if not for sale) */}\r\n      {/* Like Button (Using FaHeart) */}\r\n      {!is_for_sale && (\r\n        <button onClick={() => onLikeClick('button')} className=\"flex flex-col items-center text-white group/like\"> {/* Call prop onClick */}\r\n          <div className={`w-10 h-10 bg-black/40 rounded-full flex items-center justify-center mb-1 transition-all duration-150 ease-out ${isLiked ? 'bg-red-500/80' : 'group-hover/like:bg-white/20'} active:scale-90`}>\r\n            <FaHeart size={24} className={`${isLiked ? 'text-red-500' : 'text-white'} transition-transform group-hover/like:scale-110`} /> {/* Use isLiked prop */}\r\n          </div>\r\n          <span className=\"text-xs font-semibold\">{currentLikes}</span> {/* Use currentLikes prop */}\r\n        </button>\r\n      )}\r\n\r\n      {/* Comment Button */}\r\n      {!is_for_sale && (\r\n        <Link\r\n          href={postType === 'video' ? `/video/${postId}#comments` : `/image/${postId}#comments`}\r\n          className=\"flex flex-col items-center text-white\"\r\n          aria-label=\"View comments\"\r\n          onClick={(e) => e.stopPropagation()} // Keep stopPropagation here too\r\n        >\r\n          <div className=\"w-10 h-10 bg-black/40 rounded-full flex items-center justify-center mb-1\">\r\n            <FaCommentDots size={24} /> {/* Use FaCommentDots */}\r\n          </div>\r\n          <span className=\"text-xs font-semibold\">{commentsCount}</span>\r\n        </Link>\r\n      )}\r\n\r\n      {/* Share Button */}\r\n      {/* Share Button (Using FaShare) */}\r\n      {!is_for_sale && (\r\n        <button onClick={handleShare} className=\"flex flex-col items-center text-white group/share\">\r\n          <div className=\"w-10 h-10 bg-black/40 rounded-full flex items-center justify-center mb-1 transition-colors group-hover/share:bg-white/20\">\r\n            <FaShare size={22} className=\"transition-transform group-hover/share:scale-110\" /> {/* Use FaShare, slightly smaller */}\r\n          </div>\r\n          <span className=\"text-xs font-semibold\">{sharesCount}</span>\r\n        </button>\r\n      )}\r\n\r\n      {/* Privacy Status Display/Button REMOVED from UI stack */}\r\n\r\n\r\n      {/* Buy Button (Conditional - Now removed entirely for sale items based on feedback) */}\r\n      {/* {is_for_sale && price && price > 0 && !isOwner && (\r\n        <button\r\n          onClick={handlePurchase}\r\n          disabled={isCheckoutLoading || !loggedInUser}\r\n          className=\"flex flex-col items-center text-white group/buy mt-2\"\r\n          aria-label={`Purchase for ${(price / 100).toFixed(2)} ${currency?.toUpperCase() ?? 'USD'}`}\r\n        >\r\n          <div className={`w-10 h-10 bg-green-600/80 hover:bg-green-500/90 rounded-full flex items-center justify-center mb-1 transition-colors`}>\r\n            {isCheckoutLoading ? <Loader2 className=\"h-5 w-5 animate-spin\" /> : <ShoppingCart size={24} />}\r\n          </div>\r\n          <span className=\"text-xs font-semibold\">Buy (${(price / 100).toFixed(2)})</span>\r\n        </button>\r\n      )} */}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 381, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-background text-foreground\",\r\n        destructive:\r\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Alert = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\r\n>(({ className, variant, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    role=\"alert\"\r\n    className={cn(alertVariants({ variant }), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlert.displayName = \"Alert\"\r\n\r\nconst AlertTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h5\r\n    ref={ref}\r\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertTitle.displayName = \"AlertTitle\"\r\n\r\nconst AlertDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDescription.displayName = \"AlertDescription\"\r\n\r\nexport { Alert, AlertTitle, AlertDescription }\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,2KACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 445, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\r\n        outline:\r\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2\",\r\n        sm: \"h-8 rounded-md px-3 text-xs\",\r\n        lg: \"h-10 rounded-md px-8\",\r\n        icon: \"h-9 w-9\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n  asChild?: boolean\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n    const Comp = asChild ? Slot : \"button\"\r\n    return (\r\n      <Comp\r\n        className={cn(buttonVariants({ variant, size, className }))}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,ySACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 505, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\r\n  ({ className, type, ...props }, ref) => {\r\n    return (\r\n      <input\r\n        type={type}\r\n        className={cn(\r\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,2WACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kevin/Desktop/tiktok-clone/src/app/image/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState, useContext, useCallback } from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { AuthContext } from '@/context/AuthContext';\r\nimport { PostInteractionButtons } from '@/components/PostInteractionButtons';\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport Link from 'next/link';\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Lock, Heart, MessageCircle, Bookmark, Send, X } from 'lucide-react';\r\nimport type { Tables } from \"@/lib/database.types\";\r\n\r\n// Define the type for a single post with profile info\r\ntype PostDetail = {\r\n  id: string;\r\n  user_id: string;\r\n  caption: string | null;\r\n  type: 'image';\r\n  image_url: string;\r\n  likes_count: number | null;\r\n  comments_count: number | null;\r\n  is_private: boolean | null;\r\n  is_for_sale: boolean; // Add is_for_sale\r\n  created_at: string;\r\n  profiles: {\r\n    username: string | null;\r\n    profile_picture_url: string | null;\r\n  } | null;\r\n};\r\n\r\n// Type for comments, ensuring profiles relation is correctly typed\r\ntype CommentWithProfile = Tables<'comments'> & {\r\n  profiles: Pick<Tables<'profiles'>, 'id' | 'username' | 'profile_picture_url'> | null;\r\n};\r\n\r\nexport default function ImageDetailPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const { user: loggedInUser } = useContext(AuthContext);\r\n  const postId = params.id as string;\r\n  const [post, setPost] = useState<PostDetail | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isLiked, setIsLiked] = useState(false);\r\n  const [isBookmarked, setIsBookmarked] = useState(false);\r\n  const [comments, setComments] = useState<CommentWithProfile[]>([]);\r\n  const [loadingComments, setLoadingComments] = useState(false);\r\n  const [commentError, setCommentError] = useState<string | null>(null);\r\n  const [newComment, setNewComment] = useState(\"\");\r\n\r\n  // Function to fetch comments\r\n  const fetchComments = useCallback(async () => {\r\n     if (!postId) return;\r\n     setLoadingComments(true);\r\n     setCommentError(null);\r\n     try {\r\n       // 1. Fetch comments without profile data first\r\n       const { data: commentsData, error: commentFetchError } = await supabase\r\n         .from('comments')\r\n         .select(`*`)\r\n         .eq('post_id', postId)\r\n         .order('created_at', { ascending: true });\r\n\r\n       if (commentFetchError) throw commentFetchError;\r\n       if (!commentsData) {\r\n          setComments([]);\r\n          return;\r\n       }\r\n\r\n       // 2. Extract unique user IDs\r\n       const userIds = [...new Set(commentsData.map(c => c.user_id).filter(id => id))];\r\n\r\n       // 3. Fetch profiles\r\n       const profilesMap: Map<string, Pick<Tables<'profiles'>, 'id' | 'username' | 'profile_picture_url'>> = new Map();\r\n       if (userIds.length > 0) {\r\n          const { data: profilesData, error: profilesError } = await supabase\r\n            .from('profiles')\r\n            .select('id, username, profile_picture_url')\r\n            .in('id', userIds);\r\n\r\n          if (profilesError) {\r\n             console.error(\"Error fetching comment author profiles:\", profilesError);\r\n          } else if (profilesData) {\r\n             profilesData.forEach(p => profilesMap.set(p.id, p));\r\n          }\r\n       }\r\n\r\n       // 4. Combine comments and profiles\r\n       const commentsWithProfiles = commentsData.map(comment => ({\r\n         ...comment,\r\n         profiles: profilesMap.get(comment.user_id) || null,\r\n       }));\r\n\r\n       setComments(commentsWithProfiles as CommentWithProfile[]);\r\n\r\n     } catch (err: unknown) {\r\n       const message = err instanceof Error ? err.message : String(err);\r\n       console.error(\"Error fetching comments for image:\", err);\r\n       setCommentError(`Failed to load comments: ${message}`);\r\n       setComments([]);\r\n     } finally {\r\n       setLoadingComments(false);\r\n     }\r\n  }, [postId]); // Dependency on postId\r\n\r\n  useEffect(() => {\r\n    const fetchPost = async () => {\r\n      if (!postId) {\r\n        setError(\"Post ID is missing.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const { data, error: fetchError } = await supabase\r\n          .from('posts')\r\n          .select(`*, is_for_sale, profiles (username, profile_picture_url)`) // Select is_for_sale\r\n          .eq('id', postId)\r\n          .eq('type', 'image')\r\n          .single();\r\n        if (fetchError) throw fetchError;\r\n        if (!data) throw new Error(\"Image post not found.\");\r\n        if (data.type !== 'image' || !data.image_url) throw new Error(\"Fetched post is not a valid image post.\");\r\n        setPost(data as PostDetail);\r\n      } catch (err: unknown) {\r\n        const message = err instanceof Error ? err.message : String(err);\r\n        console.error(\"Error fetching image post:\", err);\r\n        setError(message || \"Failed to load image post.\");\r\n        setPost(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    const checkLikeStatus = async () => {\r\n      if (!loggedInUser || !postId) return;\r\n      try {\r\n        const { data, error } = await supabase.from('likes').select('id').eq('user_id', loggedInUser.id).eq('post_id', postId).maybeSingle();\r\n        if (error) throw error;\r\n        setIsLiked(!!data);\r\n      } catch (error: unknown) {\r\n        const message = error instanceof Error ? error.message : String(error);\r\n        console.error('Error fetching like status for image:', message);\r\n      }\r\n    };\r\n\r\n    fetchPost();\r\n    checkLikeStatus();\r\n    fetchComments();\r\n  }, [postId, loggedInUser, fetchComments]); // Add fetchComments to dependency array\r\n\r\n  // Callbacks for interaction component\r\n  const handleLikeSuccess = useCallback((newLikesCount: number) => {\r\n    setPost(currentPost => currentPost ? { ...currentPost, likes_count: newLikesCount } : null);\r\n  }, []);\r\n\r\n  const handleCommentSuccess = useCallback(() => {\r\n    setPost(currentPost => currentPost ? { ...currentPost, comments_count: (currentPost.comments_count ?? 0) + 1 } : null);\r\n    // Refetch comments to ensure list is up-to-date after posting (simpler than merging)\r\n    fetchComments();\r\n  }, [fetchComments]); // Add fetchComments dependency\r\n\r\n  // Comment posting logic\r\n  const handlePostComment = useCallback(async () => {\r\n     if (!newComment.trim() || !loggedInUser || !postId) return;\r\n     const originalCommentText = newComment; // Store original text for potential revert\r\n     setNewComment(\"\"); // Clear input optimistically\r\n\r\n     const commentToPost = {\r\n       post_id: postId,\r\n       user_id: loggedInUser.id,\r\n       text: originalCommentText.trim(),\r\n     };\r\n\r\n     try {\r\n       const { error: insertError } = await supabase\r\n         .from('comments')\r\n         .insert(commentToPost);\r\n\r\n       if (insertError) throw insertError;\r\n\r\n       handleCommentSuccess(); // Call success callback to update count and refetch comments\r\n\r\n     } catch (err: unknown) {\r\n       const message = err instanceof Error ? err.message : String(err);\r\n       console.error(\"Error posting comment:\", err);\r\n       setCommentError(`Failed to post comment: ${message}`);\r\n       setNewComment(originalCommentText); // Revert input field on error\r\n       // No need to revert optimistic comment list update as fetchComments will run\r\n     }\r\n  }, [newComment, loggedInUser, postId, handleCommentSuccess]); // Add handleCommentSuccess dependency\r\n\r\n  // Placeholder handlers\r\n  const handleBookmark = () => setIsBookmarked(!isBookmarked);\r\n  const handleShare = () => { /* TODO */ };\r\n\r\n  // Loading/Error/Not Found states\r\n  if (loading) return <div className=\"fixed inset-0 flex justify-center items-center bg-black text-white z-50\">Loading...</div>;\r\n  if (error) return (\r\n    <div className=\"fixed inset-0 flex flex-col justify-center items-center bg-black text-white z-50 p-4\">\r\n      <Alert variant=\"destructive\" className=\"max-w-md\"><AlertTitle>Error</AlertTitle><AlertDescription>{error}</AlertDescription></Alert>\r\n      <Button variant=\"secondary\" onClick={() => router.back()} className=\"mt-4\">Go Back</Button>\r\n    </div>\r\n  );\r\n  if (!post) return (\r\n    <div className=\"fixed inset-0 flex flex-col justify-center items-center bg-black text-white z-50 p-4\">\r\n      <Alert className=\"max-w-md\"><AlertTitle>Not Found</AlertTitle><AlertDescription>This image post could not be found.</AlertDescription></Alert>\r\n      <Button variant=\"secondary\" onClick={() => router.back()} className=\"mt-4\">Go Back</Button>\r\n    </div>\r\n  );\r\n\r\n  const isOwner = loggedInUser?.id === post.user_id;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex bg-background text-foreground z-50\">\r\n       <Button variant=\"ghost\" size=\"icon\" className=\"absolute top-4 left-4 text-white bg-black/50 hover:bg-black/70 rounded-full z-50\" onClick={() => router.back()} aria-label=\"Close image\"><X size={24} /></Button>\r\n       <div className=\"flex-1 bg-black flex items-center justify-center overflow-hidden relative\">\r\n         <img src={post.image_url} alt={post.caption || 'Image post'} className=\"block max-w-full max-h-full object-contain\" />\r\n         <PostInteractionButtons\r\n           postId={post.id}\r\n           userId={post.user_id}\r\n           username={post.profiles?.username || 'Unknown User'}\r\n           profilePictureUrl={post.profiles?.profile_picture_url || undefined}\r\n           initialLikes={post.likes_count ?? 0}\r\n           initialIsLiked={isLiked}\r\n           commentsCount={(post.comments_count ?? 0).toString()}\r\n           sharesCount={'0'}\r\n           initialIsPrivate={post.is_private ?? false}\r\n           isOwner={isOwner}\r\n           postType=\"image\"\r\n           is_for_sale={post.is_for_sale ?? false} // Pass is_for_sale (default to false if null/undefined)\r\n           onLikeSuccess={handleLikeSuccess} // Pass callback\r\n         />\r\n       </div>\r\n       <div className=\"w-[400px] lg:w-[500px] border-l border-border bg-background flex flex-col h-full\">\r\n          <div className=\"p-4 border-b border-border\">\r\n             <div className=\"flex items-center justify-between mb-3\">\r\n               <Link href={`/profile/${post.profiles?.username || ''}`} className=\"flex items-center gap-2 group\">\r\n                 <Avatar className=\"w-10 h-10\"><AvatarImage src={post.profiles?.profile_picture_url || undefined} alt={post.profiles?.username || 'User'} /><AvatarFallback>{post.profiles?.username?.charAt(0).toUpperCase() || 'U'}</AvatarFallback></Avatar>\r\n                 <div><p className=\"font-semibold group-hover:underline\">{post.profiles?.username || 'Unknown User'}</p></div>\r\n               </Link>\r\n               {!isOwner && <Button variant=\"outline\" size=\"sm\">Follow</Button>}\r\n             </div>\r\n             {post.caption && <p className=\"text-sm mb-3\">{post.caption}</p>}\r\n             <div className=\"flex items-center justify-between mb-3\">\r\n               <div className=\"flex items-center gap-4\">\r\n                 <button className=\"flex items-center gap-1.5 text-sm hover:text-primary\" onClick={() => document.getElementById('comments')?.scrollIntoView({ behavior: 'smooth' })}>\r\n                   <MessageCircle size={20} />{post.comments_count ?? 0}\r\n                 </button>\r\n                 <button onClick={handleBookmark} className=\"flex items-center gap-1.5 text-sm hover:text-primary\">\r\n                   <Bookmark size={20} fill={isBookmarked ? 'currentColor' : 'none'} /> 0\r\n                 </button>\r\n               </div>\r\n               <div className=\"flex items-center gap-2\">\r\n                 <Button variant=\"ghost\" size=\"icon\" className=\"hover:bg-muted\" aria-label=\"Share options\" onClick={handleShare}><Send size={20} /></Button>\r\n               </div>\r\n             </div>\r\n          </div>\r\n          <div className=\"flex-1 overflow-y-auto p-4 space-y-4\" id=\"comments\">\r\n             {loadingComments && <p className=\"text-muted-foreground text-center\">Loading comments...</p>}\r\n             {commentError && <p className=\"text-red-500 text-center\">{commentError}</p>}\r\n             {!loadingComments && comments.length === 0 && <p className=\"text-muted-foreground text-center\">No comments yet.</p>}\r\n             {comments.map((comment) => (\r\n               <div key={comment.id} className=\"flex items-start gap-2\">\r\n                 <Avatar className=\"w-8 h-8\"><AvatarImage src={comment.profiles?.profile_picture_url ?? undefined} alt={comment.profiles?.username ?? 'User'} /><AvatarFallback>{comment.profiles?.username?.charAt(0).toUpperCase() ?? 'U'}</AvatarFallback></Avatar>\r\n                 <div className=\"text-sm flex-1\">\r\n                   <p><span className=\"font-semibold mr-1\">{comment.profiles?.username ?? 'User'}</span>{comment.text}</p>\r\n                   <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\r\n                     <span>{new Date(comment.created_at).toLocaleDateString()}</span>\r\n                   </div>\r\n                 </div>\r\n               </div>\r\n             ))}\r\n          </div>\r\n          <div className=\"p-4 border-t border-border bg-background\">\r\n             {!loggedInUser ? (\r\n               <p className=\"text-sm text-muted-foreground text-center\"><Link href=\"#\" className=\"text-primary hover:underline\" onClick={(e) => { e.preventDefault(); /* TODO: Trigger login modal */ }}>Log in</Link> to add a comment.</p>\r\n             ) : (\r\n               <div className=\"flex items-center gap-2\">\r\n                 <Input placeholder=\"Add comment...\" className=\"flex-1\" value={newComment} onChange={(e) => setNewComment(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && handlePostComment()} />\r\n                 <Button onClick={handlePostComment} disabled={!newComment.trim()}>Post</Button>\r\n               </div>\r\n             )}\r\n          </div>\r\n       </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}
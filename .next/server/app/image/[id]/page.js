(()=>{var e={};e.id=1202,e.ids=[1202],e.modules={2505:(e,t,r)=>{Promise.resolve().then(r.bind(r,13824))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\kevin\\\\Downloads\\\\Clone-https___www.tiktok.com_\\\\temp_unzip\\\\tiktok-clone\\\\src\\\\app\\\\image\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\kevin\\Downloads\\Clone-https___www.tiktok.com_\\temp_unzip\\tiktok-clone\\src\\app\\image\\[id]\\page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12233:(e,t,r)=>{Promise.resolve().then(r.bind(r,5914))},13824:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(60687),i=r(43210),a=r(16189),n=r(66464),o=r(18780),l=r(46569),c=r(32584),d=r(85814),u=r.n(d),m=r(91821),p=r(29523),x=r(89667),f=r(78726),h=r(86910),g=r(20660),v=r(85866);function b(){let e=(0,a.useParams)(),t=(0,a.useRouter)(),{user:r}=(0,i.useContext)(o.cy),d=e.id,[b,k]=(0,i.useState)(null),[j,_]=(0,i.useState)(!0),[w,N]=(0,i.useState)(null),[y,C]=(0,i.useState)(!1),[q,z]=(0,i.useState)(!1),[A,P]=(0,i.useState)([]),[S,U]=(0,i.useState)(!1),[E,L]=(0,i.useState)(null),[D,$]=(0,i.useState)(""),F=(0,i.useCallback)(async()=>{if(d){U(!0),L(null);try{let{data:e,error:t}=await n.N.from("comments").select("*").eq("post_id",d).order("created_at",{ascending:!0});if(t)throw t;if(!e)return void P([]);let r=[...new Set(e.map(e=>e.user_id).filter(e=>e))],s=new Map;if(r.length>0){let{data:e,error:t}=await n.N.from("profiles").select("id, username, profile_picture_url").in("id",r);t?console.error("Error fetching comment author profiles:",t):e&&e.forEach(e=>s.set(e.id,e))}let i=e.map(e=>({...e,profiles:s.get(e.user_id)||null}));P(i)}catch(t){let e=t instanceof Error?t.message:String(t);console.error("Error fetching comments for image:",t),L(`Failed to load comments: ${e}`),P([])}finally{U(!1)}}},[d]),I=(0,i.useCallback)(e=>{k(t=>t?{...t,likes_count:e}:null)},[]),M=(0,i.useCallback)(()=>{k(e=>e?{...e,comments_count:(e.comments_count??0)+1}:null),F()},[F]),R=(0,i.useCallback)(async()=>{if(!D.trim()||!r||!d)return;$("");let e={post_id:d,user_id:r.id,text:D.trim()};try{let{error:t}=await n.N.from("comments").insert(e);if(t)throw t;M()}catch(t){let e=t instanceof Error?t.message:String(t);console.error("Error posting comment:",t),L(`Failed to post comment: ${e}`),$(D)}},[D,r,d,M]);if(j)return(0,s.jsx)("div",{className:"fixed inset-0 flex justify-center items-center bg-black text-white z-50",children:"Loading..."});if(w)return(0,s.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black text-white z-50 p-4",children:[(0,s.jsxs)(m.Fc,{variant:"destructive",className:"max-w-md",children:[(0,s.jsx)(m.XL,{children:"Error"}),(0,s.jsx)(m.TN,{children:w})]}),(0,s.jsx)(p.$,{variant:"secondary",onClick:()=>t.back(),className:"mt-4",children:"Go Back"})]});if(!b)return(0,s.jsxs)("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-black text-white z-50 p-4",children:[(0,s.jsxs)(m.Fc,{className:"max-w-md",children:[(0,s.jsx)(m.XL,{children:"Not Found"}),(0,s.jsx)(m.TN,{children:"This image post could not be found."})]}),(0,s.jsx)(p.$,{variant:"secondary",onClick:()=>t.back(),className:"mt-4",children:"Go Back"})]});let T=r?.id===b.user_id;return(0,s.jsxs)("div",{className:"fixed inset-0 flex bg-background text-foreground z-50",children:[(0,s.jsx)(p.$,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 text-white bg-black/50 hover:bg-black/70 rounded-full z-50",onClick:()=>t.back(),"aria-label":"Close image",children:(0,s.jsx)(f.A,{size:24})}),(0,s.jsxs)("div",{className:"flex-1 bg-black flex items-center justify-center overflow-hidden relative",children:[(0,s.jsx)("img",{src:b.image_url,alt:b.caption||"Image post",className:"block max-w-full max-h-full object-contain"}),(0,s.jsx)(l.M,{postId:b.id,userId:b.user_id,username:b.profiles?.username||"Unknown User",profilePictureUrl:b.profiles?.profile_picture_url||void 0,initialLikes:b.likes_count??0,initialIsLiked:y,commentsCount:(b.comments_count??0).toString(),sharesCount:"0",initialIsPrivate:b.is_private??!1,isOwner:T,postType:"image",is_for_sale:b.is_for_sale??!1,onLikeSuccess:I})]}),(0,s.jsxs)("div",{className:"w-[400px] lg:w-[500px] border-l border-border bg-background flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)(u(),{href:`/profile/${b.profiles?.username||""}`,className:"flex items-center gap-2 group",children:[(0,s.jsxs)(c.eu,{className:"w-10 h-10",children:[(0,s.jsx)(c.BK,{src:b.profiles?.profile_picture_url||void 0,alt:b.profiles?.username||"User"}),(0,s.jsx)(c.q5,{children:b.profiles?.username?.charAt(0).toUpperCase()||"U"})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"font-semibold group-hover:underline",children:b.profiles?.username||"Unknown User"})})]}),!T&&(0,s.jsx)(p.$,{variant:"outline",size:"sm",children:"Follow"})]}),b.caption&&(0,s.jsx)("p",{className:"text-sm mb-3",children:b.caption}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("button",{className:"flex items-center gap-1.5 text-sm hover:text-primary",onClick:()=>document.getElementById("comments")?.scrollIntoView({behavior:"smooth"}),children:[(0,s.jsx)(h.A,{size:20}),b.comments_count??0]}),(0,s.jsxs)("button",{onClick:()=>z(!q),className:"flex items-center gap-1.5 text-sm hover:text-primary",children:[(0,s.jsx)(g.A,{size:20,fill:q?"currentColor":"none"})," 0"]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(p.$,{variant:"ghost",size:"icon",className:"hover:bg-muted","aria-label":"Share options",onClick:()=>{},children:(0,s.jsx)(v.A,{size:20})})})]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",id:"comments",children:[S&&(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading comments..."}),E&&(0,s.jsx)("p",{className:"text-red-500 text-center",children:E}),!S&&0===A.length&&(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:"No comments yet."}),A.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsxs)(c.eu,{className:"w-8 h-8",children:[(0,s.jsx)(c.BK,{src:e.profiles?.profile_picture_url??void 0,alt:e.profiles?.username??"User"}),(0,s.jsx)(c.q5,{children:e.profiles?.username?.charAt(0).toUpperCase()??"U"})]}),(0,s.jsxs)("div",{className:"text-sm flex-1",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-semibold mr-1",children:e.profiles?.username??"User"}),e.text]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:(0,s.jsx)("span",{children:new Date(e.created_at).toLocaleDateString()})})]})]},e.id))]}),(0,s.jsx)("div",{className:"p-4 border-t border-border bg-background",children:r?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.p,{placeholder:"Add comment...",className:"flex-1",value:D,onChange:e=>$(e.target.value),onKeyPress:e=>"Enter"===e.key&&R()}),(0,s.jsx)(p.$,{onClick:R,disabled:!D.trim(),children:"Post"})]}):(0,s.jsxs)("p",{className:"text-sm text-muted-foreground text-center",children:[(0,s.jsx)(u(),{href:"#",className:"text-primary hover:underline",onClick:e=>{e.preventDefault()},children:"Log in"})," to add a comment."]})})]})]})}},18939:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=r(65239),i=r(48088),a=r(88170),n=r.n(a),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["image",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5914)),"C:\\Users\\kevin\\Downloads\\Clone-https___www.tiktok.com_\\temp_unzip\\tiktok-clone\\src\\app\\image\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Users\\kevin\\Downloads\\Clone-https___www.tiktok.com_\\temp_unzip\\tiktok-clone\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\Users\\kevin\\Downloads\\Clone-https___www.tiktok.com_\\temp_unzip\\tiktok-clone\\src\\app\\image\\[id]\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/image/[id]/page",pathname:"/image/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20660:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},85866:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},86910:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},91645:e=>{"use strict";e.exports=require("net")},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>l,TN:()=>d,XL:()=>c});var s=r(60687),i=r(43210),a=r(24224),n=r(4780);let o=(0,a.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=i.forwardRef(({className:e,variant:t,...r},i)=>(0,s.jsx)("div",{ref:i,role:"alert",className:(0,n.cn)(o({variant:t}),e),...r}));l.displayName="Alert";let c=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));c.displayName="AlertTitle";let d=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,353,2733,5597,3023],()=>r(18939));module.exports=s})();